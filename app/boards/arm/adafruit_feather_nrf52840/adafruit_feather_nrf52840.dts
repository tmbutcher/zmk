/*
* Copyright (c) 2022 The ZMK Contributors
*
* SPDX-License-Identifier: MIT
 */

 /dts-v1/;
 #include <nordic/nrf52840_qiaa.dtsi>
 #include "feather_connector.dtsi"
 #include "adafruit_feather_nrf52840_pinctrl.dtsi"
 
 / {
	 model = "Adafruit Feather nRF52840 Express ZMK";
	 compatible = "adafruit,feather-nrf52840-zmk";
 
	 chosen {
		 zephyr,code-partition = &code_partition;
		 zephyr,sram = &sram0;
		 zephyr,flash = &flash0;
		 zephyr,console = &cdc_acm_uart;
		 zmk,battery = &vbatt;
	 };
 
	 leds {
		 compatible = "gpio-leds";
		 led0: led_0 {
			 gpios = <&gpio1 15 0>;
			 label = "Red LED";
		 };
		 blue_led: led_1 {
			 gpios = <&gpio1 10 0>;
			 label = "Blue LED";
		 };
	 };

	 vbatt: vbatt {
		compatible = "zmk,battery-voltage-divider";
		label = "VBATT";
		io-channels = <&adc 5>;
		output-ohms = <100000>;
		full-ohms = <(100000 + 100000)>;
	 };
 
	 /* These aliases are provided for compatibility with samples */
	 aliases {
		 led0 = &led0;
		 led1 = &blue_led;
	 };
 };
 
 &adc {
	 status = "okay";
 };
 
 &gpiote {
	 status = "okay";
 };
 
 &gpio0 {
	 status = "okay";
 };
 
 &gpio1 {
	 status = "okay";
 };
 
 &uart0 {
	compatible = "nordic,nrf-uart";
	current-speed = <115200>;
	status = "okay";
	pinctrl-0 = <&uart0_default>;
	pinctrl-1 = <&uart0_sleep>;
	pinctrl-names = "default", "sleep";
};

&i2c0 {
	compatible = "nordic,nrf-twi";
	status = "okay";
	pinctrl-0 = <&i2c0_default>;
	pinctrl-1 = <&i2c0_sleep>;
	pinctrl-names = "default", "sleep";
};

&spi1 {
	compatible = "nordic,nrf-spi";
	status = "okay";
	pinctrl-0 = <&spi1_default>;
	pinctrl-1 = <&spi1_sleep>;
	pinctrl-names = "default", "sleep";
};

&qspi {
	status = "okay";
	pinctrl-0 = <&qspi_default>;
	pinctrl-1 = <&qspi_sleep>;
	pinctrl-names = "default", "sleep";
	gd25q16: gd25q16@0 {
		compatible = "nordic,qspi-nor";
		reg = <0>;
		writeoc = "pp4o";
		readoc = "read4io";
		sck-frequency = <16000000>;
		jedec-id = [c8 40 15];
		size = <16777216>;
		has-dpd;
		t-enter-dpd = <20000>;
		t-exit-dpd = <20000>;
		quad-enable-requirements = "S2B1v1";
	};
};

&ieee802154 {
	status = "okay";
};

 
 &flash0 {
	 /*
	  * For more information, see:
	  * https://docs.zephyrproject.org/latest/guides/dts/legacy-macros.html#legacy-flash-partitions
	  */
	 partitions {
		compatible = "fixed-partitions";
		#address-cells = <1>;
		#size-cells = <1>;

		sd_partition: partition@0 {
			label = "softdevice";
			reg = <0x00000000 0x00026000>;
		};
		code_partition: partition@26000 {
			label = "code_partition";
			reg = <0x00026000 0x000c6000>;
		};

		/*
		 * The flash starting at 0x000ec000 and ending at
		 * 0x000f3fff is reserved for use by the application.
		 */

		/*
		 * Storage partition will be used by FCB/LittleFS/NVS
		 * if enabled.
		 */
		storage_partition: partition@ec000 {
			label = "storage";
			reg = <0x000ec000 0x00008000>;
		};

		boot_partition: partition@f4000 {
			label = "adafruit_boot";
			reg = <0x000f4000 0x0000c000>;
		};
	 };
 };
 
 &usbd {
	 /*compatible = "nordic,nrf-usbd";*/
	 status = "okay";
	 cdc_acm_uart: cdc_acm_uart {
     compatible = "zephyr,cdc-acm-uart";
     label = "CDC_ACM_0";
  };
 };
